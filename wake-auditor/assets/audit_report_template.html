<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½åˆçº¦å®‰å…¨å®¡è®¡æŠ¥å‘Š</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .summary-card h3 {
            margin: 0 0 10px 0;
            color: #495057;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .number {
            font-size: 2em;
            font-weight: bold;
            margin: 0;
        }

        .high { color: #dc3545; }
        .medium { color: #ffc107; }
        .low { color: #28a745; }
        .info { color: #17a2b8; }

        .content {
            padding: 30px;
        }

        .vulnerability {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: box-shadow 0.3s ease;
        }

        .vulnerability:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .vulnerability-header {
            padding: 20px;
            border-left: 4px solid;
            background: #f8f9fa;
        }

        .vulnerability.high .vulnerability-header {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .vulnerability.medium .vulnerability-header {
            border-left-color: #ffc107;
            background: #fffbf0;
        }

        .vulnerability.low .vulnerability-header {
            border-left-color: #28a745;
            background: #f8fff9;
        }

        .vulnerability-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .vulnerability-title h3 {
            margin: 0;
            font-size: 1.2em;
        }

        .severity-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
            color: white;
        }

        .severity-badge.high { background: #dc3545; }
        .severity-badge.medium { background: #ffc107; color: #333; }
        .severity-badge.low { background: #28a745; }

        .vulnerability-details {
            padding: 20px;
            border-top: 1px solid #e9ecef;
        }

        .code-snippet {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 10px 0;
        }

        .recommendation {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }

        .file-info {
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            text-align: center;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .summary {
                padding: 20px;
                grid-template-columns: repeat(2, 1fr);
            }

            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <header class="header">
            <h1>æ™ºèƒ½åˆçº¦å®‰å…¨å®¡è®¡æŠ¥å‘Š</h1>
            <p>é¡¹ç›®åç§°: <span id="project-name">--</span> | ç”Ÿæˆæ—¶é—´: <span id="report-date">--</span></p>
        </header>

        <!-- æ‘˜è¦ç»Ÿè®¡ -->
        <section class="summary">
            <div class="summary-card">
                <h3>æ‰«ææ–‡ä»¶æ•°</h3>
                <p class="number info" id="total-files">0</p>
            </div>
            <div class="summary-card">
                <h3>å‘ç°æ¼æ´</h3>
                <p class="number info" id="total-vulnerabilities">0</p>
            </div>
            <div class="summary-card">
                <h3>é«˜å±æ¼æ´</h3>
                <p class="number high" id="high-severity">0</p>
            </div>
            <div class="summary-card">
                <h3>ä¸­å±æ¼æ´</h3>
                <p class="number medium" id="medium-severity">0</p>
            </div>
            <div class="summary-card">
                <h3>ä½å±æ¼æ´</h3>
                <p class="number low" id="low-severity">0</p>
            </div>
        </section>

        <!-- æ¼æ´è¯¦æƒ… -->
        <main class="content">
            <h2>æ¼æ´è¯¦æƒ…</h2>
            <div id="vulnerabilities-list">
                <!-- æ¼æ´åˆ—è¡¨å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </main>

        <!-- æŠ¥å‘Šå°¾éƒ¨ -->
        <footer class="footer">
            <p>æœ¬æŠ¥å‘Šç”± Wake Auditor è‡ªåŠ¨ç”Ÿæˆ | å»ºè®®ç»“åˆäººå·¥å®¡è®¡è¿›è¡Œç»¼åˆè¯„ä¼°</p>
        </footer>
    </div>

    <script>
        // ç¤ºä¾‹æ•°æ® - å®é™…ä½¿ç”¨æ—¶ä» Wake åˆ†æç»“æœåŠ è½½
        const reportData = {
            projectName: "DeFi Protocol",
            reportDate: new Date().toLocaleDateString('zh-CN'),
            summary: {
                totalFiles: 5,
                totalVulnerabilities: 8,
                highSeverity: 2,
                mediumSeverity: 3,
                lowSeverity: 3
            },
            vulnerabilities: [
                {
                    type: "é‡å…¥æ”»å‡»é£é™©",
                    severity: "high",
                    file: "contracts/Bank.sol",
                    line: 45,
                    description: "å¤–éƒ¨è°ƒç”¨åè¿›è¡ŒçŠ¶æ€æ”¹å˜ï¼Œå¯èƒ½å¯¼è‡´é‡å…¥æ”»å‡»",
                    codeSnippet: "(bool success, ) = msg.sender.call{value: amount}(\"\");\nbalances[msg.sender] -= amount;",
                    recommendation: "ä½¿ç”¨ Checks-Effects-Interactions æ¨¡å¼ï¼Œå…ˆæ”¹å˜çŠ¶æ€å†è¿›è¡Œå¤–éƒ¨è°ƒç”¨"
                },
                {
                    type: "è®¿é—®æ§åˆ¶æ¼æ´",
                    severity: "high",
                    file: "contracts/Admin.sol",
                    line: 23,
                    description: "å…¬å…±å‡½æ•°ç¼ºå°‘è®¿é—®æ§åˆ¶ï¼Œä»»ä½•åœ°å€éƒ½å¯ä»¥è°ƒç”¨",
                    codeSnippet: "function setOwner(address newOwner) public {\n    owner = newOwner;\n}",
                    recommendation: "æ·»åŠ  onlyOwner ä¿®é¥°ç¬¦æˆ– require(msg.sender == owner) æ£€æŸ¥"
                },
                {
                    type: "æ•´æ•°æº¢å‡ºé£é™©",
                    severity: "medium",
                    file: "contracts/Token.sol",
                    line: 67,
                    description: "ç®—æœ¯è¿ç®—å¯èƒ½å­˜åœ¨æº¢å‡ºé£é™©",
                    codeSnippet: "totalSupply += amount;",
                    recommendation: "ä½¿ç”¨ SafeMath åº“æˆ–å‡çº§åˆ° Solidity 0.8.0+"
                }
            ]
        };

        // æ¸²æŸ“æŠ¥å‘Š
        function renderReport(data) {
            // æ›´æ–°æ‘˜è¦ä¿¡æ¯
            document.getElementById('project-name').textContent = data.projectName;
            document.getElementById('report-date').textContent = data.reportDate;
            document.getElementById('total-files').textContent = data.summary.totalFiles;
            document.getElementById('total-vulnerabilities').textContent = data.summary.totalVulnerabilities;
            document.getElementById('high-severity').textContent = data.summary.highSeverity;
            document.getElementById('medium-severity').textContent = data.summary.mediumSeverity;
            document.getElementById('low-severity').textContent = data.summary.lowSeverity;

            // æ¸²æŸ“æ¼æ´åˆ—è¡¨
            const vulnerabilitiesList = document.getElementById('vulnerabilities-list');

            if (data.vulnerabilities.length === 0) {
                vulnerabilitiesList.innerHTML = '<p style="text-align: center; color: #28a745; font-size: 1.2em;">ğŸ‰ æœªå‘ç°å®‰å…¨æ¼æ´ï¼</p>';
                return;
            }

            data.vulnerabilities.forEach(vuln => {
                const vulnerabilityDiv = document.createElement('div');
                vulnerabilityDiv.className = `vulnerability ${vuln.severity}`;

                vulnerabilityDiv.innerHTML = `
                    <div class="vulnerability-header">
                        <div class="vulnerability-title">
                            <h3>${vuln.type}</h3>
                            <span class="severity-badge ${vuln.severity}">${vuln.severity === 'high' ? 'é«˜å±' : vuln.severity === 'medium' ? 'ä¸­å±' : 'ä½å±'}</span>
                        </div>
                        <div class="file-info">ğŸ“ ${vuln.file}:${vuln.line}</div>
                        <p>${vuln.description}</p>
                    </div>
                    <div class="vulnerability-details">
                        <h4>ä»£ç ç‰‡æ®µ:</h4>
                        <div class="code-snippet">${vuln.codeSnippet}</div>

                        <h4>ä¿®å¤å»ºè®®:</h4>
                        <div class="recommendation">
                            <strong>å»ºè®®:</strong> ${vuln.recommendation}
                        </div>
                    </div>
                `;

                vulnerabilitiesList.appendChild(vulnerabilityDiv);
            });
        }

        // é¡µé¢åŠ è½½æ—¶æ¸²æŸ“æŠ¥å‘Š
        document.addEventListener('DOMContentLoaded', function() {
            renderReport(reportData);
        });

        // æ”¯æŒä»å¤–éƒ¨åŠ è½½æ•°æ®
        function loadReportData(jsonData) {
            try {
                const data = typeof jsonData === 'string' ? JSON.parse(jsonData) : jsonData;
                renderReport(data);
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                document.getElementById('vulnerabilities-list').innerHTML =
                    '<p style="text-align: center; color: #dc3545;">åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®æ ¼å¼</p>';
            }
        }

        // å¯¼å‡ºå‡½æ•°ä¾›å¤–éƒ¨è°ƒç”¨
        window.loadReportData = loadReportData;
    </script>
</body>
</html>